apiVersion: "sparkoperator.k8s.io/v1beta2"
kind: ScheduledSparkApplication
metadata:
  name: my-spark-app-tenant1
  namespace: tenant1
spec:
  schedule: "*/3 * * * *"
  concurrencyPolicy: Forbid
  template:
    type: Scala
    mode: cluster
    image: "eragani/spark:3.3.1"
    mainClass: "step1.UserCDCEventProcessor"
    mainApplicationFile: "local:///opt/suite/audience2.0/Audience-assembly-0.1.0.jar"
    sparkVersion: "3.3.1"
    restartPolicy:
      type: Never
    driver:
      cores: 1
      coreLimit: "1200m"
      memory: "512m"
      labels:
        version: 3.3.1
      serviceAccount: spark
    executor:
      cores: 1
      instances: 5
      memory: "512m"
      labels:
        version: 3.3.1
    sparkConf:
      #"spark.kubernetes.namespace": "tenant1"
      "spark.kubernetes.authenticate.driver.serviceAccountName": "spark"
      "spark.kubernetes.container.image": "eragani/spark:3.3.1"
      "spark.kubernetes.driver.container.image": "eragani/spark:3.3.1"
      "spark.kubernetes.executor.container.image": "eragani/spark:3.3.1"
      "spark.eventLog.enabled": "false"
      "spark.kubernetes.container.image.pullSecrets": "docker-secret"
    arguments:
      - "au03_sales_test"

